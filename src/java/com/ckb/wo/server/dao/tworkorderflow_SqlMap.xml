<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="tworkorderflow">
  <resultMap class="com.ckb.wo.client.model.WorkOrderFlow" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    <result column="tworkorderflow_pk" jdbcType="LONG" property="tworkorderflowPk" />
    <result column="tworkorder_fk" jdbcType="LONG" property="tworkorderFk" />
    <result column="employeeid" jdbcType="VARCHAR" property="employeeid" />
    <result column="actiondate" jdbcType="TIMESTAMP" property="actiondate" />
    <result column="actiondone" jdbcType="BIT" property="actiondone" />
    <result column="level_id" jdbcType="VARCHAR" property="levelId" />
    <result column="granted" jdbcType="BIT" property="granted" />
    <result column="onbehalfemployeeid" jdbcType="VARCHAR" property="onbehalfemployeeid" />
    <result column="reason" jdbcType="VARCHAR" property="reason" />
    <result column="oldwostatus" jdbcType="VARCHAR" property="oldwostatus" />
  </resultMap>
  <sql id="ibatorgenerated_Example_Where_Clause">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    <iterate conjunction="or" prepend="where" property="oredCriteria" removeFirstPrepend="iterate">
      <isEqual compareValue="true" property="oredCriteria[].valid">
        (
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithoutValue">
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithSingleValue">
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithListValue">
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate close=")" conjunction="," open="(" property="oredCriteria[].criteriaWithListValue[].values">
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithBetweenValue">
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" parameterClass="com.ckb.wo.client.model.WorkOrderFlowExample" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    select tworkorderflow_pk, tworkorder_fk, employeeid, actiondate, actiondone, level_id, granted,
      onbehalfemployeeid, reason, oldwostatus
    from tworkorderflow
    <isParameterPresent>
      <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause">
        order by $orderByClause$
      </isNotNull>
      <isNotNull property="limitClause">
        limit $limitClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="com.ckb.wo.client.model.WorkOrderFlow" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    select tworkorderflow_pk, tworkorder_fk, employeeid, actiondate, actiondone, level_id, granted,
      onbehalfemployeeid, reason, oldwostatus
    from tworkorderflow
    where tworkorderflow_pk = #tworkorderflowPk:LONG#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.ckb.wo.client.model.WorkOrderFlow">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    delete from tworkorderflow
    where tworkorderflow_pk = #tworkorderflowPk:LONG#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.ckb.wo.client.model.WorkOrderFlowExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    delete from tworkorderflow
    <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.ckb.wo.client.model.WorkOrderFlow">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    insert into tworkorderflow (tworkorder_fk, employeeid, actiondate, actiondone, level_id,
      granted, onbehalfemployeeid, reason, oldwostatus)
    values (#tworkorderFk:LONG#, #employeeid:VARCHAR#, #actiondate:TIMESTAMP#, #actiondone:BIT#,
      #levelId:VARCHAR#, #granted:BIT#, #onbehalfemployeeid:VARCHAR#, #reason:VARCHAR#,
      #oldwostatus:VARCHAR#)
    <selectKey keyProperty="tworkorderflowPk" resultClass="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.ckb.wo.client.model.WorkOrderFlow">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    insert into tworkorderflow
    <dynamic prepend="(">
      <isNotNull prepend="," property="tworkorderFk">
        tworkorder_fk
      </isNotNull>
      <isNotNull prepend="," property="employeeid">
        employeeid
      </isNotNull>
      <isNotNull prepend="," property="actiondate">
        actiondate
      </isNotNull>
      <isNotNull prepend="," property="actiondone">
        actiondone
      </isNotNull>
      <isNotNull prepend="," property="levelId">
        level_id
      </isNotNull>
      <isNotNull prepend="," property="granted">
        granted
      </isNotNull>
      <isNotNull prepend="," property="onbehalfemployeeid">
        onbehalfemployeeid
      </isNotNull>
      <isNotNull prepend="," property="reason">
        reason
      </isNotNull>
      <isNotNull prepend="," property="oldwostatus">
        oldwostatus
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="tworkorderFk">
        #tworkorderFk:LONG#
      </isNotNull>
      <isNotNull prepend="," property="employeeid">
        #employeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="actiondate">
        #actiondate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="actiondone">
        #actiondone:BIT#
      </isNotNull>
      <isNotNull prepend="," property="levelId">
        #levelId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="granted">
        #granted:BIT#
      </isNotNull>
      <isNotNull prepend="," property="onbehalfemployeeid">
        #onbehalfemployeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reason">
        #reason:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="oldwostatus">
        #oldwostatus:VARCHAR#
      </isNotNull>
      )
    </dynamic>
    <selectKey keyProperty="tworkorderflowPk" resultClass="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.ckb.wo.client.model.WorkOrderFlowExample" resultClass="java.lang.Integer">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    select count(*) from tworkorderflow
    <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    update tworkorderflow
    <dynamic prepend="set">
      <isNotNull prepend="," property="record.tworkorderflowPk">
        tworkorderflow_pk = #record.tworkorderflowPk:LONG#
      </isNotNull>
      <isNotNull prepend="," property="record.tworkorderFk">
        tworkorder_fk = #record.tworkorderFk:LONG#
      </isNotNull>
      <isNotNull prepend="," property="record.employeeid">
        employeeid = #record.employeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.actiondate">
        actiondate = #record.actiondate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.actiondone">
        actiondone = #record.actiondone:BIT#
      </isNotNull>
      <isNotNull prepend="," property="record.levelId">
        level_id = #record.levelId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.granted">
        granted = #record.granted:BIT#
      </isNotNull>
      <isNotNull prepend="," property="record.onbehalfemployeeid">
        onbehalfemployeeid = #record.onbehalfemployeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.reason">
        reason = #record.reason:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.oldwostatus">
        oldwostatus = #record.oldwostatus:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent>
      <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    update tworkorderflow
    set tworkorderflow_pk = #record.tworkorderflowPk:LONG#,
      tworkorder_fk = #record.tworkorderFk:LONG#,
      employeeid = #record.employeeid:VARCHAR#,
      actiondate = #record.actiondate:TIMESTAMP#,
      actiondone = #record.actiondone:BIT#,
      level_id = #record.levelId:VARCHAR#,
      granted = #record.granted:BIT#,
      onbehalfemployeeid = #record.onbehalfemployeeid:VARCHAR#,
      reason = #record.reason:VARCHAR#,
      oldwostatus = #record.oldwostatus:VARCHAR#
    <isParameterPresent>
      <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.ckb.wo.client.model.WorkOrderFlow">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    update tworkorderflow
    <dynamic prepend="set">
      <isNotNull prepend="," property="tworkorderFk">
        tworkorder_fk = #tworkorderFk:LONG#
      </isNotNull>
      <isNotNull prepend="," property="employeeid">
        employeeid = #employeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="actiondate">
        actiondate = #actiondate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="actiondone">
        actiondone = #actiondone:BIT#
      </isNotNull>
      <isNotNull prepend="," property="levelId">
        level_id = #levelId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="granted">
        granted = #granted:BIT#
      </isNotNull>
      <isNotNull prepend="," property="onbehalfemployeeid">
        onbehalfemployeeid = #onbehalfemployeeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reason">
        reason = #reason:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="oldwostatus">
        oldwostatus = #oldwostatus:VARCHAR#
      </isNotNull>
    </dynamic>
    where tworkorderflow_pk = #tworkorderflowPk:LONG#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.ckb.wo.client.model.WorkOrderFlow">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Aug 16 17:24:26 SGT 2010.
    -->
    update tworkorderflow
    set tworkorder_fk = #tworkorderFk:LONG#,
      employeeid = #employeeid:VARCHAR#,
      actiondate = #actiondate:TIMESTAMP#,
      actiondone = #actiondone:BIT#,
      level_id = #levelId:VARCHAR#,
      granted = #granted:BIT#,
      onbehalfemployeeid = #onbehalfemployeeid:VARCHAR#,
      reason = #reason:VARCHAR#,
      oldwostatus = #oldwostatus:VARCHAR#
    where tworkorderflow_pk = #tworkorderflowPk:LONG#
  </update>
  <!--  custom resultmap -->
  <resultMap class="com.ckb.wo.client.model.WorkOrderFlow" extends="tworkorderflow.ibatorgenerated_BaseResultMap" id="ResultMapWithJoinUserAndLevel">
	<result property="user" resultMap="tuser.ibatorgenerated_BaseResultMap" />
	<result property="level" resultMap="tlevel.ibatorgenerated_BaseResultMap" />		  
  </resultMap>  
  
  <!-- custom query -->
  <select id="getWorkOrderValidatedByThisUser" parameterClass="com.ckb.wo.client.model.WorkOrderFlow" resultClass="java.lang.Long">
  	select tworkorder_fk from tworkorderflow where employeeId=#employeeid:VARCHAR# and oldwostatus=#oldwostatus:VARCHAR#
  </select>

  <select id="getApprovalHistoryForThisWorkOrder" parameterClass="com.ckb.wo.client.model.ExtendedWorkOrderFlowExample" resultMap="ResultMapWithJoinUserAndLevel">
  	select atuser.employee_id as atuser_employee_id, atuser.first_name as atuser_first_name,
	      atuser.middle_name as atuser_middle_name, atuser.last_name as atuser_last_name,
	      atuser.grantfrom as atuser_grantfrom, atuser.grantto as atuser_grantto, atuser.bossemployeeid
	      as atuser_bossemployeeid, atuser.email as atuser_email, atuser.area_id as atuser_area_id,
	      atuser.division_id as atuser_division_id, atuser.department_id as atuser_department_id,
	      atuser.station_id as atuser_station_id, atuser.job_title_id as atuser_job_title_id,
	      atuser.level_id as atuser_level_id, atuser.isactiveuser as atuser_isactiveuser  	
  	,tworkorderflow.*, tlevel.description, tlevel.level_value
    from tworkorderflow left outer join tuser atuser
  	on tworkorderflow.employeeid=atuser.employee_id 
  	left outer join tlevel on 
  	tworkorderflow.level_id=tlevel.level_id
    <isParameterPresent>
      <include refid="tworkorderflow.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause">
        order by $orderByClause$
      </isNotNull>
      <isNotNull property="limitClause">
        limit $limitClause$
      </isNotNull>
    </isParameterPresent>  	
  </select>  

</sqlMap>